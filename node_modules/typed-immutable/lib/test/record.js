(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./test", "immutable", "../record", "../typed"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./test"), require("immutable"), require("../record"), require("../typed"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.test, global.Immutable, global.record, global.typed);
    global.record = mod.exports;
  }
})(this, function (exports, _test, _immutable, _record, _typed) {
  "use strict";

  var Point = (0, _record.Record)({
    x: Number(0),
    y: Number(0)
  }, "Point");

  (0, _test["default"])("reading record short-cirquits", function (assert) {
    var v = Point();
    var reader = (0, _typed.typeOf)(Point);

    assert.equal(reader[_typed.Typed.read](v), v);
  });

  (0, _test["default"])("reading records", function (assert) {
    var reader = (0, _typed.typeOf)(Point);

    var v1 = reader[_typed.Typed.read]();
    var v2 = reader[_typed.Typed.read]({ x: 10 });
    var v3 = reader[_typed.Typed.read]({ y: 10 });
    var v4 = reader[_typed.Typed.read]({ x: 1, y: 2 });

    assert.ok(v1 instanceof _record.Record);
    assert.ok(v2 instanceof _record.Record);
    assert.ok(v3 instanceof _record.Record);
    assert.ok(v4 instanceof _record.Record);

    assert.ok(v1 instanceof Point);
    assert.ok(v2 instanceof Point);
    assert.ok(v3 instanceof Point);
    assert.ok(v4 instanceof Point);

    assert.deepEqual(v1.toJSON(), { x: 0, y: 0 });
    assert.deepEqual(v2.toJSON(), { x: 10, y: 0 });
    assert.deepEqual(v3.toJSON(), { x: 0, y: 10 });
    assert.deepEqual(v4.toJSON(), { x: 1, y: 2 });
  });

  var identity = function identity(x) {
    return x;
  };
  (0, _test["default"])("identical on no change", function (assert) {
    var p1 = Point({ x: 5 });

    assert.equal(p1, p1.set("x", 5));
    assert.equal(p1, p1.merge({ x: 5 }));
    assert.equal(p1, p1.merge({ y: 0 }));
    assert.equal(p1, p1.merge({ x: 5, y: 0 }));
    assert.equal(p1, p1.remove("y"));
    assert.equal(p1, p1.update("x", identity));
    assert.equal(p1, p1.update("y", identity));
  });

  (0, _test["default"])("identical no change in deep updates", function (assert) {
    var Line = (0, _record.Record)({ start: Point, end: Point }, "Line");

    var l1 = Line({ start: { x: 5 }, end: { x: 7, y: 2 } });

    assert.equal(l1, l1.set("start", l1.start));
    assert.equal(l1, l1.set("end", l1.end));

    assert.equal(l1, l1.merge({ start: l1.start }));
    assert.equal(l1, l1.merge({ end: l1.end }));
    assert.equal(l1, l1.merge({ start: l1.start, end: l1.end }));
    assert.equal(l1, l1.removeIn(["start", "y"]));
    assert.equal(l1, l1.setIn(["start", "x"], 5));
    assert.equal(l1, l1.setIn(["start", "x"], 5).setIn(["end", "x"], 7));
    assert.equal(l1, l1.mergeIn(["start"], { x: 5 }));
    assert.equal(l1, l1.mergeIn(["start"], { x: 5, y: 0 }));
    assert.equal(l1, l1.mergeIn(["start"], { y: 0 }));
    assert.equal(l1, l1.mergeIn(["end"], { y: 2 }));
    assert.equal(l1, l1.mergeIn(["end"], { x: 7 }));
    assert.equal(l1, l1.mergeIn(["end"], { y: 2, x: 7 }));

    assert.equal(l1, l1.update("start", function (p) {
      return p.set("x", 5);
    }));
  });

  (0, _test["default"])("empty record optimization", function (assert) {
    var Point = (0, _record.Record)({ x: 0, y: 0 }, "Point");

    assert.equal(Point(), Point());
    assert.notEqual(Point({ x: 1 }), Point());
    assert.equal(Point({ x: 1 }).clear(), Point());
    assert.equal(Point({ x: 1 }).clear(), Point({ y: 2 }).clear());
    assert.equal(Point({}), Point());
    assert.notEqual(Point({ z: 3 }), Point());
    assert.ok(Point({ z: 3 }).equals(Point()));
    assert.notEqual(Point({ x: 0 }), Point());
    assert.ok(Point({ x: 0 }).equals(Point()));
  });
});
//# sourceMappingURL=data:application/json;base64,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QTs7QUFHRixNQUFNLFFBQVEsR0FBRyxTQUFYLFFBQVEsQ0FBRyxDQUFDO1dBQUksQ0FBQztHQUFBLENBQUE7QUFDdkIsd0JBQUssd0JBQXdCLEVBQUUsVUFBQSxNQUFNLEVBQUk7QUFDdkMsUUFBSSxFQUFFLEdBQUcsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUM7O0FBRXZCLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakMsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkMsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDbkMsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQztBQUN6QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDakMsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUMzQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO0dBQzVDLENBQUMsQ0FBQTs7QUFFRix3QkFBSyxxQ0FBcUMsRUFBRSxVQUFBLE1BQU0sRUFBSTtBQUNwRCxRQUFJLElBQUksR0FBRyxZQXZETCxNQUFNLEVBdURNLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFDLEVBQUUsTUFBTSxDQUFDLENBQUE7O0FBRXJELFFBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFDLEtBQUssRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsRUFBRSxHQUFHLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUMsRUFBQyxDQUFDLENBQUE7O0FBRWpELFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFBO0FBQzNDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFBOztBQUV2QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLEVBQUMsQ0FBQyxDQUFDLENBQUE7QUFDN0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3pDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUMxRCxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUM3QyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDN0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FDeEIsS0FBSyxDQUFDLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDM0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUMvQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUE7QUFDckQsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQTtBQUMvQyxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzdDLFVBQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUE7QUFDN0MsVUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFBOztBQUVuRCxVQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFBLENBQUM7YUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7S0FBQSxDQUFDLENBQUMsQ0FBQTtHQUN6RCxDQUFDLENBQUE7O0FBR0Ysd0JBQUssMkJBQTJCLEVBQUUsVUFBQSxNQUFNLEVBQUk7QUFDMUMsUUFBTSxLQUFLLEdBQUcsWUFqRlIsTUFBTSxFQWlGUyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxFQUFFLE9BQU8sQ0FBQyxDQUFBOztBQUUzQyxVQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUE7QUFDOUIsVUFBTSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFBO0FBQ3ZDLFVBQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUM1QyxVQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUE7QUFDMUQsVUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUNoQyxVQUFNLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUE7QUFDdkMsVUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO0FBQ3hDLFVBQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQTtBQUN0QyxVQUFNLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUE7R0FDekMsQ0FBQyxDQUFDIiwiZmlsZSI6InJlY29yZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0ZXN0IGZyb20gXCIuL3Rlc3RcIlxuaW1wb3J0ICogYXMgSW1tdXRhYmxlIGZyb20gXCJpbW11dGFibGVcIlxuaW1wb3J0IHtSZWNvcmR9IGZyb20gXCIuLi9yZWNvcmRcIlxuaW1wb3J0IHtUeXBlZCwgdHlwZU9mLCBVbmlvbiwgTWF5YmV9IGZyb20gXCIuLi90eXBlZFwiXG5cbmNvbnN0IFBvaW50ID0gUmVjb3JkKHtcbiAgeDogTnVtYmVyKDApLFxuICB5OiBOdW1iZXIoMClcbn0sIFwiUG9pbnRcIilcblxudGVzdChcInJlYWRpbmcgcmVjb3JkIHNob3J0LWNpcnF1aXRzXCIsIGFzc2VydCA9PiB7XG4gIGNvbnN0IHYgPSBQb2ludCgpXG4gIGNvbnN0IHJlYWRlciA9IHR5cGVPZihQb2ludClcblxuICBhc3NlcnQuZXF1YWwocmVhZGVyW1R5cGVkLnJlYWRdKHYpLCB2KVxufSlcblxuXG50ZXN0KFwicmVhZGluZyByZWNvcmRzXCIsIGFzc2VydCA9PiB7XG4gIGNvbnN0IHJlYWRlciA9IHR5cGVPZihQb2ludClcblxuICBjb25zdCB2MSA9IHJlYWRlcltUeXBlZC5yZWFkXSgpXG4gIGNvbnN0IHYyID0gcmVhZGVyW1R5cGVkLnJlYWRdKHt4OjEwfSlcbiAgY29uc3QgdjMgPSByZWFkZXJbVHlwZWQucmVhZF0oe3k6MTB9KVxuICBjb25zdCB2NCA9IHJlYWRlcltUeXBlZC5yZWFkXSh7eDoxLCB5OjJ9KVxuXG4gIGFzc2VydC5vayh2MSBpbnN0YW5jZW9mIFJlY29yZClcbiAgYXNzZXJ0Lm9rKHYyIGluc3RhbmNlb2YgUmVjb3JkKVxuICBhc3NlcnQub2sodjMgaW5zdGFuY2VvZiBSZWNvcmQpXG4gIGFzc2VydC5vayh2NCBpbnN0YW5jZW9mIFJlY29yZClcblxuICBhc3NlcnQub2sodjEgaW5zdGFuY2VvZiBQb2ludClcbiAgYXNzZXJ0Lm9rKHYyIGluc3RhbmNlb2YgUG9pbnQpXG4gIGFzc2VydC5vayh2MyBpbnN0YW5jZW9mIFBvaW50KVxuICBhc3NlcnQub2sodjQgaW5zdGFuY2VvZiBQb2ludClcblxuICBhc3NlcnQuZGVlcEVxdWFsKHYxLnRvSlNPTigpLCB7eDowLHk6MH0pXG4gIGFzc2VydC5kZWVwRXF1YWwodjIudG9KU09OKCksIHt4OjEwLHk6MH0pXG4gIGFzc2VydC5kZWVwRXF1YWwodjMudG9KU09OKCksIHt4OjAseToxMH0pXG4gIGFzc2VydC5kZWVwRXF1YWwodjQudG9KU09OKCksIHt4OjEseToyfSlcbn0pXG5cblxuY29uc3QgaWRlbnRpdHkgPSB4ID0+IHhcbnRlc3QoXCJpZGVudGljYWwgb24gbm8gY2hhbmdlXCIsIGFzc2VydCA9PiB7XG4gIHZhciBwMSA9IFBvaW50KHt4OiA1fSk7XG5cbiAgYXNzZXJ0LmVxdWFsKHAxLCBwMS5zZXQoJ3gnLCA1KSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEubWVyZ2Uoe3g6IDV9KSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEubWVyZ2Uoe3k6IDB9KSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEubWVyZ2Uoe3g6IDUsIHk6IDB9KSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEucmVtb3ZlKCd5JykpO1xuICBhc3NlcnQuZXF1YWwocDEsIHAxLnVwZGF0ZSgneCcsIGlkZW50aXR5KSk7XG4gIGFzc2VydC5lcXVhbChwMSwgcDEudXBkYXRlKCd5JywgaWRlbnRpdHkpKTtcbn0pXG5cbnRlc3QoXCJpZGVudGljYWwgbm8gY2hhbmdlIGluIGRlZXAgdXBkYXRlc1wiLCBhc3NlcnQgPT4ge1xuICB2YXIgTGluZSA9IFJlY29yZCh7c3RhcnQ6IFBvaW50LCBlbmQ6IFBvaW50fSwgJ0xpbmUnKVxuXG4gIHZhciBsMSA9IExpbmUoe3N0YXJ0OiB7eDogNX0sIGVuZDoge3g6IDcsIHk6IDJ9fSlcblxuICBhc3NlcnQuZXF1YWwobDEsIGwxLnNldCgnc3RhcnQnLCBsMS5zdGFydCkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEuc2V0KCdlbmQnLCBsMS5lbmQpKVxuXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2Uoe3N0YXJ0OiBsMS5zdGFydH0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlKHtlbmQ6IGwxLmVuZH0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlKHtzdGFydDogbDEuc3RhcnQsIGVuZDogbDEuZW5kfSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEucmVtb3ZlSW4oWydzdGFydCcsICd5J10pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLnNldEluKFsnc3RhcnQnLCAneCddLCA1KSlcbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5zZXRJbihbJ3N0YXJ0JywgJ3gnXSwgNSlcbiAgICAgICAgICAgICAgICAgICAgIC5zZXRJbihbJ2VuZCcsICd4J10sIDcpKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlSW4oWydzdGFydCddLCB7eDogNX0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlSW4oWydzdGFydCddLCB7eDogNSwgeTogMH0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlSW4oWydzdGFydCddLCB7eTogMH0pKVxuICBhc3NlcnQuZXF1YWwobDEsIGwxLm1lcmdlSW4oWydlbmQnXSwge3k6IDJ9KSlcbiAgYXNzZXJ0LmVxdWFsKGwxLCBsMS5tZXJnZUluKFsnZW5kJ10sIHt4OiA3fSkpXG4gIGFzc2VydC5lcXVhbChsMSwgbDEubWVyZ2VJbihbJ2VuZCddLCB7eTogMiwgeDogN30pKVxuXG4gIGFzc2VydC5lcXVhbChsMSwgbDEudXBkYXRlKCdzdGFydCcsIHAgPT4gcC5zZXQoJ3gnLCA1KSkpXG59KVxuXG5cbnRlc3QoJ2VtcHR5IHJlY29yZCBvcHRpbWl6YXRpb24nLCBhc3NlcnQgPT4ge1xuICBjb25zdCBQb2ludCA9IFJlY29yZCh7eDogMCwgeTogMH0sICdQb2ludCcpXG5cbiAgYXNzZXJ0LmVxdWFsKFBvaW50KCksIFBvaW50KCkpXG4gIGFzc2VydC5ub3RFcXVhbChQb2ludCh7eDogMX0pLCBQb2ludCgpKVxuICBhc3NlcnQuZXF1YWwoUG9pbnQoe3g6IDF9KS5jbGVhcigpLCBQb2ludCgpKVxuICBhc3NlcnQuZXF1YWwoUG9pbnQoe3g6IDF9KS5jbGVhcigpLCBQb2ludCh7eTogMn0pLmNsZWFyKCkpXG4gIGFzc2VydC5lcXVhbChQb2ludCh7fSksIFBvaW50KCkpXG4gIGFzc2VydC5ub3RFcXVhbChQb2ludCh7ejogM30pLCBQb2ludCgpKVxuICBhc3NlcnQub2soUG9pbnQoe3o6IDN9KS5lcXVhbHMoUG9pbnQoKSkpXG4gIGFzc2VydC5ub3RFcXVhbChQb2ludCh7eDowfSksIFBvaW50KCkpXG4gIGFzc2VydC5vayhQb2ludCh7eDogMH0pLmVxdWFscyhQb2ludCgpKSlcbn0pO1xuIl19